<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Welcome to Benfei VCF</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
  :root {
    --neon: #39ff14;        /* neon green */
    --dark: #0a0a0a;
    --text: #e6ffe6;
    --accent: #14ffec;      /* cyan accent */
    --warn: #ff6f61;        /* coral red */
    --target-count: 1000;
  }
  body {
    margin: 0;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: radial-gradient(circle at top left, #001100, var(--dark));
    font-family: 'Segoe UI', Roboto, sans-serif;
    color: var(--text);
    position: relative;
    overflow: hidden;
  }

  /* particles background */
  #particles-js {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: -1; /* keep it behind */
    background: radial-gradient(circle at top left, #001100, var(--dark));
  }

  .card {
    width: 95%;
    max-width: 440px;
    background: rgba(20, 20, 20, 0.6);
    border: 2px solid var(--neon);
    border-radius: 18px;
    box-shadow: 0 0 20px var(--neon), inset 0 0 15px rgba(57,255,20,0.2);
    padding: 28px;
    text-align: center;
    animation: glow 3s infinite alternate;
    transition: transform 0.3s ease;
    z-index: 1;
  }
  .card:hover { transform: scale(1.02); }
  @keyframes glow {
    from { box-shadow: 0 0 20px var(--neon), inset 0 0 10px rgba(57,255,20,0.15); }
    to { box-shadow: 0 0 40px var(--neon), inset 0 0 25px rgba(57,255,20,0.3); }
  }
  h1 {
    font-size: 24px;
    margin-bottom: 4px; /* Adjusted margin */
    color: var(--neon);
    text-shadow: 0 0 10px var(--neon);
  }
  p { margin: 6px 0 10px; /* Adjusted margin */ font-size: 14px; color: #b3ffb3; }
  
  /* Counter styles */
  .counter {
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 10px 0;
    padding: 10px;
    background: rgba(0, 30, 0, 0.4);
    border-radius: 10px;
    border: none;
  }

  .live-indicator {
    display: inline-block;
    width: 12px;
    height: 12px;
    background: var(--neon);
    border-radius: 50%;
    margin-right: 10px;
    animation: blink 1.5s infinite alternate;
  }
  
  @keyframes blink {
    0% { transform: scale(1); opacity: 1; box-shadow: 0 0 5px var(--neon); }
    100% { transform: scale(1.2); opacity: 0.4; box-shadow: 0 0 10px var(--neon), 0 0 20px var(--neon); }
  }

  .counter-text {
    font-weight: bold;
    color: var(--neon);
    font-size: 18px;
    margin-right: 8px;
  }

  .counter-description {
    font-size: 16px;
    color: #b5ffaa;
  }
  
  /* Progress bar */
  .progress-message-container {
    text-align: left;
    margin-bottom: 2px; /* Adjusted margin */
  }

  .progress-message {
    color: var(--neon);
    font-weight: bold;
    font-size: 14px;
    text-shadow: 0 0 5px var(--neon);
  }

  .progress-container {
    width: 100%;
    height: 16px;
    background: #111;
    border-radius: 8px;
    margin-bottom: 5px; /* Adjusted margin */
    position: relative;
    border: 1px solid rgba(57, 255, 20, 0.5);
    overflow: hidden;
  }
  .progress-bar {
    height: 100%;
    width: 0;
    background: var(--neon);
    border-radius: 8px;
    transition: width 0.5s ease-in-out;
    box-shadow: 0 0 8px var(--neon), 0 0 12px var(--neon);
    position: relative;
  }

  input {
    width: 90%;
    padding: 12px;
    margin: 8px 0;
    border-radius: 8px;
    border: 1px solid var(--neon);
    background: #111;
    color: var(--text);
    transition: all 0.3s ease;
  }
  input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 8px var(--accent);
  }
  button {
    width: 100%;
    padding: 12px;
    margin-top: 8px;
    border-radius: 8px;
    border: none;
    background: var(--neon);
    color: var(--dark);
    font-weight: 700;
    font-size: 15px;
    cursor: pointer;
    transition: background 0.3s, transform 0.2s;
  }
  button:hover { background: var(--accent); transform: translateY(-2px); }
  .msg { margin-top: 14px; font-size: 14px; min-height: 18px; }
  
  /* Flexbox for equal width buttons */
  .social-buttons {
    display: flex;
    gap: 10px;
    margin-top: 12px; /* Adjusted margin */
  }

  /* Updated .wtap class for top icon */
  .wtap {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    color: var(--accent);
    font-weight: 600;
    border: 1px solid var(--accent);
    padding: 10px 14px;
    border-radius: 8px;
    transition: all 0.3s;
    flex: 1;
    max-width: 50%;
    text-align: center;
  }

  /* Updated i element for spacing */
  i {
    margin-right: 0;
    margin-bottom: 6px;
  }
  
  .wtap:hover { background: var(--accent); color: var(--dark); }
  
  /* Bouncing keyframe animation for WhatsApp button */
  .bounce {
    animation: bounce 1.8s infinite;
  }
  @keyframes bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-10px); }
    60% { transform: translateY(-5px); }
  }
  .neon-text {
    color: var(--neon);
    text-shadow: 0 0 5px var(--neon), 0 0 10px var(--neon);
    margin-top: 5px; /* Adjusted margin */
  }
  .small { font-size: 12px; margin-top: 12px; /* Adjusted margin */ color: #aaffaa; }
 
</style>
</head>
<body>
  <div id="particles-js"></div>

  <div class="card">
    <h1><i class="fas fa-address-card"></i> Welcome to Benfei VCF</h1>
    <p><i class="fas fa-upload"></i> Upload only your WhatsApp contact here. Must begin with "+" followed by country code and number</p>
    
    <div class="counter">
      <span class="live-indicator"></span>
      <span id="contactCount" class="counter-text">Loading...</span>
      <span class="counter-description"> contacts in VCF</span>
    </div>
    
    <div class="progress-message-container">
      <span id="progress-message" class="progress-message">0% of target reached</span>
    </div>

    <div class="progress-container">
      <div id="progressBar" class="progress-bar"></div>
    </div>
    <p id="downloadMessage" class="neon-text">Vcf download commences when contacts = 1000</p>

    <form id="frm" onsubmit="return false">
      <input id="name" placeholder="Full Name" autocomplete="name">
      <input id="phone" placeholder="WhatsApp Number (e.g. +234xxx...)" autocomplete="tel" required>
      <button id="submitBtn"><i class="fas fa-upload"></i> Upload Contact</button>
      <button onclick="location.href='https://chat.whatsapp.com/FSkISjIYnfhCFCvlMiuE26?mode=ems_copy_c'"><i class="fab fa-whatsapp" ></i> Join Whatsapp Group</button>
    </form>

    <div class="msg" id="msg"></div>
    
    <div class="social-buttons">
      <a id="whatsapp" class="wtap bounce" target="_blank" href="https://whatsapp.com/channel/0029Vay16NVJENy6op6dBV3B">
        <i class="fab fa-whatsapp"></i> Follow Our WhatsApp Channel
      </a>
      <a id="youtube" class="wtap bounce" target="_blank" href="https://www.youtube.com/@benfeitech">
        <i class="fab fa-youtube"></i> Subscribe To YouTube Channel 
      </a>
    </div>

    <div class="small">Powered by Benfei Tech</div>
  </div>

<script>
const msgEl = document.getElementById('msg');
const btn = document.getElementById('submitBtn');
const contactCountEl = document.getElementById('contactCount');
const progressBarEl = document.getElementById('progressBar');
const progressMessageEl = document.getElementById('progress-message'); // New element to target
const downloadMessageEl = document.getElementById('downloadMessage');
const whatsappGroupURL = 'https://chat.whatsapp.com/FSkISjIYnfhCFCvlMiuE26?mode=ems_copy_c';
const targetCount = 1000;

// Function to update the contact counter and progress bar
async function updateContactCounter() {
  try {
    const response = await fetch('/api/count');
    const data = await response.json();
    
    if (data.count !== undefined) {
      const currentCount = data.count;
      contactCountEl.textContent = currentCount.toLocaleString();
      
      // Update progress bar
      let percentage = Math.min(100, (currentCount / targetCount) * 100);
      progressBarEl.style.width = `${percentage}%`;
      
      // Update the new progress message element with the full text
      progressMessageEl.textContent = `${Math.round(percentage)}% of contacts uploaded; target => ${targetCount} contacts.`;

    } else {
      contactCountEl.textContent = 'Error';
      console.error('Unexpected response format:', data);
    }
  } catch (error) {
    console.error('Failed to fetch contact count:', error);
    contactCountEl.textContent = 'Error';
  }
}

// Initial counter update
updateContactCounter();

// Update counter every 3 seconds
setInterval(updateContactCounter, 3000);

function show(msg, color){
  msgEl.innerHTML = msg;
  msgEl.style.color = color || 'var(--neon)';
}

function normalizePhone(s){
  let plus = s.startsWith('+') ? '+' : '';
  return plus + s.replace(/\D/g,'');
}

document.getElementById('frm').addEventListener('submit', async () => {
  btn.disabled = true;
  show('Sending...');
  const name = "ðŸ’™ " + document.getElementById('name').value.trim();
  const phone = normalizePhone(document.getElementById('phone').value.trim());
  if (!phone) { 
    show('Please enter phone number', 'var(--warn)'); 
    btn.disabled=false; 
    return; 
  }
  try {
    const res = await fetch('/api/upload', {
      method:'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ name, phone })
    });
    const data = await res.json();
    if (data.exists) {
      show('âš ï¸ Phone number already exists.', 'var(--warn)');
    } else if (data.success) {
      // Show success message
      show('âœ… Contact uploaded successfully!. Join group above or you'll be redirected in seconds', 'var(--neon)');
      document.getElementById('name').value = '';
      document.getElementById('phone').value = '';
      
      // Update the counter and progress bar after successful upload
      updateContactCounter();
      
      // Set the 2-second timer for redirecting message
      setTimeout(() => {
        show('Redirecting to WhatsApp group...', 'var(--accent)');
        
        // Wait another 2 seconds, then redirect
        setTimeout(() => {
          window.location.href = whatsappGroupURL;
        }, 2000); // 2 seconds delay
        
      }, 2000); // 2 seconds delay
      
    } else {
      show(data.error || 'Unexpected error.', 'var(--warn)');
    }
  } catch (e) {
    console.error(e);
    show('Network error. Try again.', 'var(--warn)');
  } finally {
    btn.disabled = false;
  }
});
</script>

<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<script>
particlesJS("particles-js", {
  particles: {
    number: { value: 127, density: { enable: true, value_area: 800 } },
    color: { value: ["#39ff14", "#14ffec"] }, // neon green + cyan
    shape: { type: "circle" },
    opacity: { value: 1, random: false }, // solid
    size: { value: 4, random: true },
    line_linked: {
      enable: true,
      distance: 150,
      color: "#14ffec",
      opacity: 0.9,
      width: 2
    },
    move: {
      enable: true,
      speed: 2.5,
      random: true,
      out_mode: "out"
    }
  },
  interactivity: {
    detect_on: "canvas",
    events: {
      onhover: { enable: true, mode: "repulse" },
      onclick: { enable: true, mode: "push" },
      resize: true
    },
    modes: {
      repulse: { distance: 120, duration: 0.4 },
      push: { particles_nb: 5 }
    }
  },
  retina_detect: true
});

// extra CSS glow effect
const style = document.createElement("style");
style.innerHTML = `
  #particles-js canvas {
    filter: drop-shadow(0 0 6px #39ff14)
            drop-shadow(0 0 12px #14ffec);
  }
`;
document.head.appendChild(style);
</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TD8WYJG6EY"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-TD8WYJG6EY'); // replace with your ID
</script>
</body>
      </html>
      
